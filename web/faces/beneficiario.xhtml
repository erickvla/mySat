<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" 
	  xmlns:ui="http://xmlns.jcp.org/jsf/facelets" 
	  xmlns:h="http://xmlns.jcp.org/jsf/html" 
	  xmlns:f="http://xmlns.jcp.org/jsf/core" 
	  xmlns:p="http://primefaces.org/ui" 
	  xmlns:fn="http://java.sun.com/jsp/jstl/functions"
	  xmlns:mysat="http://java.sun.com/jsf/composite/components">

<ui:composition template="templates/default-template.xhtml">
	
	<ui:define name="header">
		  <ui:include src="templates/header.xhtml" />
	</ui:define>
	
	<ui:define name="leftnav">
		  <ui:include src="templates/leftnav.xhtml" />
	</ui:define>

    <ui:define name="content">	

		<h:form id="frmMySat">
		
			<p></p>
	
			<p:messages id="messages" 
						showSummary="true" 
						showDetail="false" />
			
			<p></p>
			
			<p:dataTable id="itemsDataTable" 
						 value="#{beneficiarioMBean.results.resultsList}" 
						 var="ded" 
						 rowExpandMode="single" 
						 rowKey="#{ded.id}" 
						 selection="#{beneficiarioMBean.selectedItems}" 
						 editable="true">
						 
				<p:ajax event="rowEdit"
						listener="#{beneficiarioMBean.updateItemListener}"
						update="frmMySat:messages" />
	
				<p:ajax event="rowEditCancel"
						listener="#{beneficiarioMBean.rowCancelListener}" />
						
				<p:ajax event="rowSelect"
						listener="#{beneficiarioMBean.rowSelectListener}" />
		
					<f:facet name="header">
					
						<h4>
							<h:outputText value="#{bundle['title.beneficiario']}" />
						</h4>
						
						<p:commandButton id="crearButton"  
										 type="button" 
										 onclick="PF('wCreateItemDialog').show();" 
										 value="#{bundle['button.crear']}" />
				
						<p:commandButton id="eliminarButton" 
										 type="button" 
										 widgetVar="wEliminarButton"
										 onclick="PF('wEliminarConfirmDialog').show();" 
										 value="#{bundle['button.eliminar']}" />
		
					</f:facet>
		
					<p:column selectionMode="multiple" 
							  width="40" />
			
						<p:column headerText="#{bundle['column.nombre']}" 
								  sortBy="#{ded.nombre}" 
								  filterBy="#{ded.nombre}" 
								  filterMatchMode="contains">
			
							<p:cellEditor>
								<f:facet name="output">
									<h:outputText value="#{ded.nombre}" />
								</f:facet>
								<f:facet name="input">
									<p:inputText id="editNombreInpTxt" 
												 value="#{ded.nombre}" 
												 label="#{bundle['label.nombre']}" 
										 		 required="true" 
										 		 size="40">
										<f:validateLength for="editNombreInpTxt"
														  minimum="3"
														  maximum="40" />
										<f:validator for="editNombreInpTxt" 
											 		 validatorId="deduccionValidator" />
									</p:inputText>
								</f:facet>
							</p:cellEditor>
			
						</p:column>
						
						<p:column width="55">
				
							<p:rowEditor editTitle="#{bundle['button.editar']}" 
										 saveTitle="#{bundle['button.guardar']}" 
										 cancelTitle="#{bundle['button.cancelar']}" />
			
						</p:column>
			
						<f:facet name="footer">
						
							<h:outputText value="Total de registros [#{fn:length(beneficiarioMBean.results.resultsList)}]" />
					
						</f:facet>
					
			</p:dataTable>
			
			<mysat:insertDialog id="createItemDialog" 
								ajaxActionListener="#{beneficiarioMBean.insertItemListener}">
								
				<p:outputLabel for="nombreInputText" 
							   value="#{bundle['label.nombre']}" />

				<p:inputText id="nombreInputText" 
							 label="#{bundle['label.nombre']}" 
							 required="true" 
							 size="30" 
							 value="#{beneficiarioMBean.properties.nombre}">
					<f:validateLength for="nombreInputText"
									  minimum="3"
									  maximum="40" />
					<f:validator for="nombreInputText" 
								 validatorId="deduccionValidator" />
				</p:inputText>
								
			</mysat:insertDialog>
			
			<mysat:deleteConfirmDialog id="eliminarConfirmDialog" 
									   ajaxEventListener="#{beneficiarioMBean.deleteItemsListener}" />
	
		</h:form>
	
	</ui:define>
	
	<ui:define name="footer">
		  <ui:include src="templates/footer.xhtml" />
	</ui:define>

</ui:composition>

</html>