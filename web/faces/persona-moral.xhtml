<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" 
	  xmlns:ui="http://xmlns.jcp.org/jsf/facelets" 
	  xmlns:h="http://xmlns.jcp.org/jsf/html" 
	  xmlns:f="http://xmlns.jcp.org/jsf/core" 
	  xmlns:p="http://primefaces.org/ui" 
	  xmlns:fn="http://java.sun.com/jsp/jstl/functions"
	  xmlns:mysat="http://java.sun.com/jsf/composite/components">

<ui:composition template="templates/default-template.xhtml">
	
	<ui:define name="header">
		  <ui:include src="templates/header.xhtml" />
	</ui:define>
	
	<ui:define name="leftnav">
		  <ui:include src="templates/leftnav.xhtml" />
	</ui:define>

    <ui:define name="content">	

		<h:form id="frmMySat">
			
			<p></p>
	
			<p:messages id="messages" 
						showSummary="true" 
						showDetail="false" />
			
			<p></p>
			
			<p:dataTable id="itemsDataTable" 
						 value="#{personaMoralMBean.results.resultsList}" 
						 var="pem" 
						 rowExpandMode="single" 
						 rowKey="#{pem.id}" 
						 selection="#{personaMoralMBean.selectedItems}" 
						 editable="true"
						 emptyMessage="#{bundle['message.datatable.empty']}">
						 
				<p:ajax event="rowEdit"
						listener="#{personaMoralMBean.updateItemListener}"
						update="frmMySat:messages" />
	
				<p:ajax event="rowEditCancel"
						listener="#{personaMoralMBean.rowCancelListener}" />
						
				<p:ajax event="rowSelect"
						listener="#{personaMoralMBean.rowSelectListener}" />
		
				<f:facet name="header">
				
					<h4>
						<h:outputText value="#{bundle['title.persona.moral']}" />
					</h4>
					
					<p:commandButton id="crearButton"  
										 type="button" 
										 onclick="PF('wCreateItemDialog').show();" 
										 value="#{bundle['button.crear']}" />
									 
					<p:commandButton id="eliminarButton" 
										 type="button" 
										 widgetVar="wEliminarButton"
										 onclick="PF('wEliminarConfirmDialog').show();" 
										 value="#{bundle['button.eliminar']}" />
	
				</f:facet>
	
				<p:column selectionMode="multiple" 
						  width="40" />
		
				<p:column headerText="#{bundle['column.razon.social']}" 
						  sortBy="#{pem.nombre}" 
						  filterBy="#{pem.nombre}" 
						  filterMatchMode="contains">
	
					<p:cellEditor>
						<f:facet name="output">
							<h:outputText value="#{pem.nombre}" />
						</f:facet>
						<f:facet name="input">
							<p:inputText id="editNombreInpTxt" 
										 value="#{pem.nombre}" 
										 label="#{bundle['label.nombre']}" 
								 		 required="true" 
								 		 size="30">
								<f:validateLength for="editNombreInpTxt"
												  minimum="3"
												  maximum="80" />
								<f:validator for="editNombreInpTxt" 
									 		 validatorId="razonSocialValidator" />
							</p:inputText>
						</f:facet>
					</p:cellEditor>
	
				</p:column>
	
				<p:column headerText="#{bundle['column.rfc']}" 
						  sortBy="#{pem.rfc}" 
						  filterBy="#{pem.rfc}" 
						  filterMatchMode="contains">
	
					<p:cellEditor>
						<f:facet name="output">
							<h:outputText value="#{pem.rfc}" />
						</f:facet>
						<f:facet name="input">
							<p:inputText id="editRfcInpTxt" 
										 value="#{pem.rfc}" 
										 label="#{bundle['label.rfc']}" 
								 		 required="true" 
								 		 size="15" 
								 		 style="text-transform: uppercase"
								 		 converter="uppercaseConverter">
								<f:validateLength for="editRfcInpTxt"
												  minimum="12"
												  maximum="13" />
								<f:validator for="editRfcInpTxt" 
									 		 validatorId="rfcMoralValidator" />
							</p:inputText>
						</f:facet>
					</p:cellEditor>
	
				</p:column>
				
				<p:column width="55">
		
					<p:rowEditor editTitle="#{bundle['button.editar']}" 
								 saveTitle="#{bundle['button.guardar']}" 
								 cancelTitle="#{bundle['button.cancelar']}" />
	
				</p:column>
				
				<p:column width="55">
				
					<p:commandButton id="viewItemCmdBtn" 
									 icon="fa fa-fw fa-search" 
									 type="button" 
									 title="#{bundle['button.ver']}">
									 
						<p:ajax event="click" 
								listener="#{personaMoralMBean.viewItemListener(pem)}"
								oncomplete="PF('wViewItemDlg').show()" 
								update=":frmMySat:viewItemDlg:viewItemOutPnl" />
						
					</p:commandButton>
	
				</p:column>
	
				<f:facet name="footer">
				
					<h:outputText value="Total de registros [#{fn:length(personaMoralMBean.results.resultsList)}]" />
			
				</f:facet>
					
			</p:dataTable>
			
			<mysat:insertDialog id="createItemDialog" 
								ajaxActionListener="#{personaMoralMBean.insertItemListener}">
								
				<p:outputLabel for="nombreInputText" 
							   value="#{bundle['label.razon.social']}" />

				<p:inputText id="nombreInputText" 
							 label="#{bundle['label.razon.social']}" 
							 required="true" 
							 size="30" 
							 value="#{personaMoralMBean.properties.nombre}">
					<f:validateLength for="nombreInputText"
									  minimum="3"
									  maximum="80" />
					<f:validator for="nombreInputText" 
								 validatorId="razonSocialValidator" />
				</p:inputText>

				<p:outputLabel for="rfcInputText"
							   value="#{bundle['label.rfc']}" />

				<p:inputText id="rfcInputText" 
							 label="#{bundle['label.rfc']}" 
							 required="true" 
							 size="15" 
							 value="#{personaMoralMBean.properties.rfc}"
							 style="text-transform: uppercase"
							 converter="uppercaseConverter">
					<f:validateLength for="rfcInputText"
									  minimum="12"
									  maximum="13" />
					<f:validator for="rfcInputText" 
								 validatorId="rfcMoralValidator" />
				</p:inputText>
								
			</mysat:insertDialog>
			
			<mysat:viewDialog id="viewItemDlg">
					  
				<p:panelGrid id="viewItemPnlGrd"
							 columns="2"
							 layout="grid"
							 style="margin: 30px">
							 
					<h:outputText value="#{bundle['label.razon.social']}" />
					
					<h:outputText value="#{bundle['label.rfc']}" />
					
					<h:outputText value="#{personaMoralMBean.selected.nombre}" />
					
					<h:outputText value="#{personaMoralMBean.selected.rfc}" />
				
				</p:panelGrid>
				
			</mysat:viewDialog>
			
			<mysat:deleteConfirmDialog id="eliminarConfirmDialog" 
									   ajaxEventListener="#{personaMoralMBean.deleteItemsListener}" />
	
		</h:form>
	
	</ui:define>
	
	<ui:define name="footer">
		  <ui:include src="templates/footer.xhtml" />
	</ui:define>

</ui:composition>

</html>